Implementation of SO(n) for Shonan Averaging